- alias: WakeUp Light Bedroom
  id: '1516469487030'
  hide_entity: true
  trigger:
    platform: template
    value_template: '{{states.sensor.time.state == states.sensor.wakeup_start_time_lights.state}}'
  condition:
    condition: and
    conditions:
    - condition: state
      entity_id: input_boolean.wakeup
      state: 'on'
    - condition: or
      conditions:
      - condition: state
        entity_id: input_boolean.wakeup_weekends
        state: 'on'
      - condition: time
        weekday:
        - mon
        - tue
        - wed
        - thu
        - fri
  action:
    service: script.wakeup_bedroom
- alias: Weekday Morning On
  action:
    service: script.scene_morning
  condition:
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
  id: '1517158114659'
  trigger:
  - at: 05:30
    platform: time
- action:
  - data:
      entity_id:
      - light.tak_1
      - light.tak_2
      - light.tak_3
      - light.hue_vardagsrum
    service: light.turn_off
  - data:
      entity_id:
      - switch.plant_light
      - switch.cupboard_light
    service: switch.turn_off
  alias: Weekday Morning Off
  condition:
  - condition: time
    weekday:
    - mon
    - tue
    - wed
    - thu
    - fri
  id: '1517160306581'
  trigger:
  - event: sunrise
    offset: 02:00:00
    platform: sun
- action:
  - data:
    service: script.scene_evening
  alias: Evening Light On
  condition:
  - after: sunset
    after_offset: -03:00:00
    condition: sun
  id: '1517169567056'
  trigger:
  - entity_id: device_tracker.alberts_iphone
    from: away
    platform: state
    to: home
  - entity_id: device_tracker.astrid_sin_iphone
    from: away
    platform: state
    to: home
- action:
  - data:
      entity_id: switch.heater_livingroom
    service: switch.turn_on
  alias: Heating Morning On
  condition: []
  id: '1517551858893'
  trigger:
  - at: 05:00
    platform: time
- action:
  - data:
      entity_id: switch.heater_livingroom
    service: switch.turn_off
  alias: Heating Morning Off
  condition: []
  id: '1517551936701'
  trigger:
  - at: 07:30
    platform: time
- action:
  - data:
      entity_id: switch.heater_livingroom
    service: switch.turn_on
  alias: Heating Evening On
  condition: []
  id: '1517551977011'
  trigger:
  - at: '16:00'
    platform: time
- action:
  - data:
      entity_id: switch.heater_livingroom
    service: switch.turn_off
  alias: Heating Evening Off
  condition: []
  id: '1517552024666'
  trigger:
  - at: '21:30'
    platform: time
- action:
  - data:
      color_temp: 370
      entity_id:
      - light_tak_1
      - light_tak_2
      - light_tak_3
    service: light.turn_on
  alias: Sunset temperature change 1
  condition: []
  id: '1520144586626'
  trigger:
  - event: sunset
    platform: sun
- action:
  - data:
      color_temp: 457
      entity_id:
      - light_tak_1
      - light_tak_2
      - light_tak_3
    service: light.turn_on
  alias: Sunset temperature change 2
  condition: []
  id: '1520144636923'
  trigger:
  - event: sunset
    offset: '2:00:00'
    platform: sun

- action:
  - data_template:
      entity_id: input_number.wakeup_hour 
      value: '{{trigger["payload_json"]["alarm_time"][0]}}'
    service: input_number.set_value
  - data_template:
      entity_id: input_number.wakeup_minutes 
      value: '{{trigger["payload_json"]["alarm_time"][1]}}'
    service: input_number.set_value
  id: '1520145586600'
  alias: Move Alarm
  trigger:
    platform: mqtt
    topic: "alarm_clock"

- action:
  - data_template:
      entity_id: '{{"input_boolean.wakeup" if not trigger["payload_json"]["alarm_is_enabled"]}}'
    service: input_boolean.turn_off
  id: '1520145586601'
  alias: Disable Alarm
  trigger:
    platform: mqtt
    topic: "alarm_clock"

- action:
  - data_template:
      entity_id: '{{"input_boolean.wakeup" if trigger["payload_json"]["alarm_is_enabled"]}}'
    service: input_boolean.turn_on
  id: '1520145586602'
  alias: Enable Alarm
  trigger:
    platform: mqtt
    topic: "alarm_clock"
